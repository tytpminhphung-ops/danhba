<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Danh sách Google Sheet</title>

    <!-- Bootstrap -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- DataTable Bootstrap 5 -->
    <link rel="stylesheet"
          href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

</head>

<body class="p-4">

<h3 class="mb-4">Danh sách nhân sự (từ Google Sheet)</h3>

<table id="myTable" class="table table-striped table-bordered" style="width:100%">
    <thead>
        <tr>
            <th>STT</th>
            <th>Họ và tên</th>
            <th>Chức vụ</th>
            <th>Chức danh</th>
            <th>Điện thoại</th>
            <th>Email cá nhân</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
$(document).ready(function () {

    const sheetURL =
      "https://docs.google.com/spreadsheets/d/1Vpq9LUlp-9yH24_kRzpc9OxGNhvlGfiQDwGA9jA6qHk/export?format=csv";

    fetch(sheetURL)
        .then(res => res.text())
        .then(csv => {
            let rows = csv.split("\n").map(r => r.split(","));

            rows.shift(); // Bỏ dòng header

            rows.forEach(r => {
                $("#myTable tbody").append(`
                    <tr>
                        <td>${r[0] || ""}</td>
                        <td>${r[1] || ""}</td>
                        <td>${r[2] || ""}</td>
                        <td>${r[3] || ""}</td>
                        <td>${r[4] || ""}</td>
                        <td>${r[5] || ""}</td>
                    </tr>
                `);
            });

            // Khởi tạo DataTable
            $("#myTable").DataTable({
                language: {
                    url: "https://cdn.datatables.net/plug-ins/1.13.6/i18n/vi.json"
                },
                pageLength: 20,
                responsive: true
            });
        });
});
</script>
</body>
</html>
